## [1.14.6] - 2026-01-04

### Changed
- **CRITICAL: Refactored global variables to improve testability** (IMPROVEMENTS.md High Priority #3)
  - Removed global variables (`csvWriter`, `csvFile`, `verboseMode`)
  - Created `Config` struct to hold application configuration
  - Created `CSVLogger` struct with methods for CSV logging operations
  - Converted to dependency injection pattern - all functions now receive config and logger as parameters
  - Improved code testability and maintainability
  - Easier to write unit tests without global state
  - Better separation of concerns

### Added
- `Config` struct for application configuration
- `CSVLogger` struct for CSV logging with methods:
  - `NewCSVLogger()` - Constructor that creates and initializes logger
  - `WriteRow()` - Writes a row to CSV (replaces global `writeCSVRow()`)
  - `writeHeader()` - Private method for writing CSV headers
  - `Close()` - Closes CSV file properly (replaces global `closeCSVLog()`)

### Removed
- Global variables: `csvWriter`, `csvFile`, `verboseMode`
- Deprecated functions: `initCSVLog()`, `closeCSVLog()`, `writeCSVRow()`, `writeCSVHeader()`
- All functionality replaced by CSVLogger struct methods

### Technical Details
- All action functions (`listEvents`, `sendEmail`, `createInvite`, `listInbox`) now accept `config` and `logger` parameters
- `getCredential()` accepts `config` parameter for verbose logging
- `createFileAttachments()` accepts `config` parameter for verbose logging
- `logVerbose()` now accepts verbose flag as first parameter instead of reading global variable
- CSV logger properly handles nil checks (gracefully continues without logging if logger initialization fails)
